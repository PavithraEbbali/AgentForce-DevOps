#!/usr/bin/env node

/**
 * Cline-powered Component Generator
 * Automatically generates React TypeScript components
 */

const fs = require('fs');
const path = require('path');

function generateComponent(componentName) {
  return `import React from 'react';

interface ${componentName}Props {
  className?: string;
}

/**
 * ${componentName} Component
 * Auto-generated by Cline CLI automation
 */
export default function ${componentName}({ className = '' }: ${componentName}Props) {
  return (
    <div className={\`p-6 rounded-lg border \${className}\`}>
      <h2 className="text-2xl font-bold mb-4">${componentName}</h2>
      <p className="text-gray-600">Component content goes here</p>
    </div>
  );
}
`;
}

function generateTest(componentName) {
  return `import { render, screen } from '@testing-library/react';
import ${componentName} from './${componentName}';

describe('${componentName}', () => {
  it('renders the component', () => {
    render(<${componentName} />);
    expect(screen.getByText('${componentName}')).toBeInTheDocument();
  });
});
`;
}

// Main execution
const componentName = process.argv[2];

if (!componentName) {
  console.error('‚ùå Usage: node component-generator.js ComponentName');
  process.exit(1);
}

if (!/^[A-Z]/.test(componentName)) {
  console.error('‚ùå Component name must start with uppercase letter');
  process.exit(1);
}

const componentsDir = path.join(__dirname, '..', 'src', 'components');
if (!fs.existsSync(componentsDir)) {
  fs.mkdirSync(componentsDir, { recursive: true });
}

const componentFile = path.join(componentsDir, `${componentName}.tsx`);
const testFile = path.join(componentsDir, `${componentName}.test.tsx`);

if (fs.existsSync(componentFile)) {
  console.error(`‚ùå Component ${componentName} already exists`);
  process.exit(1);
}

fs.writeFileSync(componentFile, generateComponent(componentName));
fs.writeFileSync(testFile, generateTest(componentName));

console.log(`‚úÖ Generated: src/components/${componentName}.tsx`);
console.log(`‚úÖ Generated: src/components/${componentName}.test.tsx`);
console.log(`\nüéâ Success! Component ready to use.`);
